jQuery(document).ready(function(){function r(r){var t=jQuery.parseJSON(r),s=t.data.post_id+"-"+t.data.sequence,e=jQuery("#rating-form-"+s);if("success"==t.status){var a=jQuery(".rating-result-"+t.data.post_id).filter(".mr-filter");a&&a.replaceWith(t.data.html)}if(jQuery("#rating-form-"+s+" .rating-item .mr-error").html(""),t.validation_results&&t.validation_results.length>0||t.message){var m="";if(t.validation_results){var l=0;for(l;l<t.validation_results.length;l++)t.validation_results[l].field&&jQuery("#"+t.validation_results[l].field+"-"+t.data.sequence+"-error").length?jQuery("#"+t.validation_results[l].field+"-"+t.data.sequence+"-error").html(t.validation_results[l].message):m+='<p class="mr message mr-'+t.validation_results[l].severity+'">'+t.validation_results[l].message+"</p>"}t.message&&(m+='<p class="message '+t.status+'">'+t.message+"</p>"),e&&e.parent().find(".message")&&e.parent().find(".message").remove(),e&&e.parent()&&e.before(m)}"success"==t.status&&1==t.data.hide_rating_form&&e&&e.remove();var u="mr-spinner-"+s;jQuery("#"+u).remove()}function t(r,t){var e=s(r);null!=e&&(m[e]=t)}function s(r){var t=r.split("-"),s=t[4],e=t[5],a="rating-item-"+s+"-"+e;return a}function e(r){var t=r.id,s=t.split("-"),e=s[1],a=s[4],m=s[5],l="#rating-item-"+a+"-"+m;jQuery(l).val(e)}var a=jQuery.parseJSON(mr_frontend_data.icon_classes);jQuery(".rating-form :button").click(function(t){{var s=[],e=t.currentTarget.id,m=e.split("-"),l=m[1],u=m[2],o="#ratingEntryId-"+l+"-"+u;jQuery(o)}jQuery('.rating-form input[type="hidden"].rating-item-'+l+"-"+u).each(function(r){var t=jQuery(this).val(),e=jQuery("[name=rating-item-"+t+"-"+u+"]"),a=null;a=jQuery(e).is(":radio")?jQuery('input[type="radio"][name=rating-item-'+t+"-"+u+"]:checked").val():jQuery(e).is("select")?jQuery("select[name=rating-item-"+t+"-"+u+"] :selected").val():jQuery("input[type=hidden][name=rating-item-"+t+"-"+u+"]").val();var m={id:t,value:a};s[r]=m});var n={action:"save_rating",nonce:mr_frontend_data.ajax_nonce,ratingItems:s,postId:l,sequence:u},i=l+"-"+u,d="mr-spinner-"+i;jQuery('<i style="margin-left: 10px;" id="'+d+'" class="'+a.spinner+'"></i>').insertAfter("input#"+e),jQuery.post(mr_frontend_data.ajax_url,n,function(t){r(t)})});var m={},l=jQuery.parseJSON(mr_frontend_data.use_custom_star_images);jQuery(".mr-star-rating-select .mr-star-empty, .mr-star-rating-select .mr-star-full").on("click",function(){t(this.id,"clicked"),1==l?(jQuery(this).not(".mr-minus").removeClass("mr-custom-empty-star mr-star-empty mr-custom-hover-star mr-star-hover").addClass("mr-custom-full-star mr-star-full"),jQuery(this).prevAll().not(".mr-minus").removeClass("mr-custom-empty-star mr-star-empty mr-custom-hover-star mr-star-hover").addClass("mr-custom-full-star mr-star-full"),jQuery(this).nextAll().not(".mr-minus").removeClass("mr-custom-full-star mr-star-full mr-custom-hover-star mr-star-hover").addClass("mr-custom-empty-star mr-star-empty")):(jQuery(this).not(".mr-minus").removeClass(a.star_empty+" "+a.star_hover).addClass(a.star_full),jQuery(this).prevAll().not(".mr-minus").removeClass(a.star_empty+" "+a.star_hover).addClass(a.star_full),jQuery(this).nextAll().not(".mr-minus").removeClass(a.star_full+" "+a.star_hover).addClass(a.star_empty)),e(this)}),jQuery(".mr-star-rating-select .mr-minus").on("click",function(){t(this.id,""),1==l?(jQuery(this).not(".mr-minus").removeClass("mr-custom-empty-star mr-star-empty mr-custom-hover-star mr-star-hover").addClass("mr-custom-full-star mr-star-full"),jQuery(this).prevAll().not(".mr-minus").removeClass("mr-custom-empty-star mr-star-empty mr-custom-hover-star mr-star-hover").addClass("mr-custom-full-star mr-star-full"),jQuery(this).nextAll().not(".mr-minus").removeClass("mr-custom-full-star mr-star-full mr-custom-hover-star mr-star-hover").addClass("mr-custom-empty-star mr-star-empty")):(jQuery(this).not(".mr-minus").removeClass(a.star_empty+" "+a.star_hover).addClass(a.star_full),jQuery(this).prevAll().not(".mr-minus").removeClass(a.star_empty+" "+a.star_hover).addClass(a.star_full),jQuery(this).nextAll().not(".mr-minus").removeClass(a.star_full+" "+a.star_hover).addClass(a.star_empty)),e(this)}),jQuery(".mr-star-rating-select .mr-minus, .mr-star-rating-select .mr-star-empty, .mr-star-rating-select .mr-star-full").on("mouseenter mouseleave",function(){var r=this.id,e=s(r);(0==jQuery("#"+e).val()||"clicked"!=m[e]&&void 0!=m[e])&&(t(this.id,"hovered"),1==l?(jQuery(this).not(".mr-minus").removeClass("mr-custom-empty-star mr-star-empty").addClass("mr-custom-hover-star mr-star-hover"),jQuery(this).prevAll().not(".mr-minus").removeClass("mr-custom-empty-star mr-star-empty").addClass("mr-custom-hover-star mr-star-hover"),jQuery(this).nextAll().not(".mr-minus").removeClass("mr-custom-hover-star mr-star-hover mr-custom-full-star mr-star-full").addClass("mr-custom-empty-star mr-star-empty")):(jQuery(this).not(".mr-minus").removeClass(a.star_empty).addClass(a.star_hover),jQuery(this).prevAll().not(".mr-minus").removeClass(a.star_empty).addClass(a.star_hover),jQuery(this).nextAll().not(".mr-minus").removeClass(a.star_hover+" "+a.star_full).addClass(a.star_empty)))});var u={started:null,currrentX:0,yCoord:0,previousXCoord:0,previousYCoord:0,touch:null};jQuery(".mr-star-rating-select .mr-star-empty, .mr-star-rating-select .mr-star-full, .mr-star-rating-select .mr-minus").on("touchstart",function(r){u.started=(new Date).getTime();var t=r.originalEvent.touches[0];u.previousXCoord=t.pageX,u.previousYCoord=t.pageY,u.touch=t}),jQuery(".mr-star-rating-select .mr-star-empty, .mr-star-rating-select .mr-star-full, .mr-star-rating-select .mr-minus").on("touchend touchcancel",function(){var r=(new Date).getTime();if(null!==u.started&&r-u.started<200&&null!==u.touch){var t=u.touch,s=t.pageX,m=t.pageY;u.previousXCoord===s&&u.previousYCoord===m&&(1==l?(jQuery(this).not(".mr-minus").removeClass("mr-custom-empty-star mr-star-empty").addClass("mr-custom-full-star mr-star-full"),jQuery(this).prevAll().not(".mr-minus").removeClass("mr-custom-empty-star mr-star-empty").addClass("mr-custom-full-star mr-star-full"),jQuery(this).nextAll().not(".mr-minus").removeClass("mr-custom-full-star mr-star-full").addClass("mr-custom-empty-star mr-star-empty")):(jQuery(this).not(".mr-minus").removeClass(a.star_empty).addClass(a.star_full),jQuery(this).prevAll().not(".mr-minus").removeClass(a.star_empty).addClass(a.star_full),jQuery(this).nextAll().not(".mr-minus").removeClass(a.star_full).addClass(a.star_empty)),e(this))}u.started=null,u.touch=null})});